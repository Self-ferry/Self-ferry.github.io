<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta http-equiv="Content-Language" content="zh-cn">
<title>PE?????????</title>
</head>

<body>

<h1><a></a>1 ????????</h1>

<p>?°¿??????????????ß÷??ßª????</p>


<table border="1" cellspacing="1">
 <tr>
  <td width="65" align="center">????</td>
  <td align="center">????</td>
 </tr>
 <tr>
  <td width="65">???</td>
  <td>??????????????????????????????????????????????????????????????¶À????????????????????ûD??????????????¶À????????????????????????????????????????????????????????????????????????????</td>
 </tr>
 <tr>
  <td width="65">???????</td>
  <td>??????EXE?????????????????????????DLL?????????????????????????®¢???????????????????????????????????ó®?ß≥????????????????????????????????????^0^</td>
 </tr>
 <tr>
  <td width="65">RVA</td>
  <td>??????Relatively Virtual Address???????????????????????????????????????</td>
 </tr>
 <tr>
  <td width="65">??</td>
  <td>????PE????ß’??????????????????????????????????????????????????</td>
 </tr>
 <tr>
  <td width="65">VA</td>
  <td>??????Virtual Address?????</td>
 </tr>
 </table>


<h1><a name="2"></a>2 ????</h1>
<p>x86????32¶À???IA-64????64¶À???64¶ÀWindows?????????????PE?????????????????????????????PE32+??????????????¶ ????????PE?????????????????????????????ßª???32¶À?????64¶À????????????????ß’??????????32¶À??64¶ÀPE????????</p>
<p>EXE?????DLL?????????????????????????????????????PE?????¶∏????????????¶À?????¶À???????????????EXE????DLL??????DLL?????????????????????????????DLL??????????????????????.OCX???????????ß≥????.CPL??????DLL??</p>
<p align="center">
<img border="0" src="pe.gif" width="332" height="443"></p>
<p align="center">?1 ??????Microsoft PE?????????????</p>
<p>PE??????????????????????????????????????????????????????????????????è`??</p>

<h1><a name="3"></a>3 ????</h1>

<p>PE?????????DOS???NT??????????????????????????????????????????????????????????????????????????????????®¥???SizeOfHeaders??????¶∂?????????????????????????3???????????????????????????</p>
<p>?????????NT????µµ</p>
<h2><a name="3.1"></a>3.1 DOS???<b>PE?????????????</b>?????ß≥??</h2>
<p>?®π??°¿????¶ ????????????????2??????????????MZ????????Mark Zbikowski????????ß’???????????MS-DOS???????????????ßª??MS-DOS????ßª????????ßª????????MS-DOS?????ß⁄®Æ???????????????ßª???????¶¬?????????????0x3C????60?????????????4????<b>PE?????????????</b>???????????????????????E_lfanew?????????????PE00?????????P?????E???????????<b>?????</b>??????????E_lfanew???????MS-DOS?????????????????MS-DOS???????®Æ??????????????????exe??com???????????MS-DOS?????????????????This program cannot be run in DOS mode???????????DOS???????ßµ???????????????????????????®Æ?????ßª????????????????????????ßª?????????????DOS??????????Windows???????????Notepad.exe????DOS???ß≥?224??????????????DOS?????ß÷?Win32?????????????MS-DOS????????ß·??????????????????ß≥???????ß≥???????MS-DOS???????????????????0??</p>
<h2><a name="3.2"></a>3.2 NT???244??260??????</h2>
<p>??????PE???????????NT???NT????3????????????2??????32??64¶À???????????3???????????????????????????</p>
<p>??1?????20??????</p>

<table border="1" width="985" cellspacing="1">
 <tr>
  <td width="40" align="center">???</td>
  <td width="40" align="center">??ß≥</td>
  <td width="160" align="center">?????</td>
  <td align="center" width="110">??????</td>
  <td align="center" width="623">????</td>
 </tr>
 <tr>
  <td width="40">0</td>
  <td width="40">2</td>
  <td width="160">Machine</td>
  <td width="110">??????</td>
  <td width="623">???CPU????????¶œ?3.2.1???<a href="#3.2.1">????????</a>????</td>
 </tr>
 <tr>
  <td width="40">2</td>
  <td width="40">2</td>
  <td width="160">NumberOfSections</td>
  <td width="110">????</td>
  <td width="623">????????Windows???????????????????96??</td>
 </tr>
 <tr>
  <td width="40">4</td>
  <td width="40">4</td>
  <td width="160">TimeDateStamp</td>
  <td width="110">???/??????</td>
  <td width="623">UTC???1970??1??1??00:00????????????32¶À?????????????????????</td>
 </tr>
 <tr>
  <td width="40">8</td>
  <td width="40">8</td>
  <td width="480" colspan="3">??????</td>
 </tr>
 <tr>
  <td width="40">16</td>
  <td width="40">2</td>
  <td width="160">SizeOfOptionalHeader</td>
  <td width="110">??????ß≥</td>
  <td width="623">??2????+??3????????ß≥???????ß≥??32¶À??64¶À????????????????32¶À????????????224??????64¶À????????????240??</td>
 </tr>
 <tr>
  <td width="40">18</td>
  <td width="40">2</td>
  <td width="160">FillCharacteristics</td>
  <td width="110">????????</td>
  <td width="623">???????????????¶œ?3.2.2???<a href="#3.2.2">????</a>????</td>
 </tr>
</table>

<p>??2?????96??112??????</p>
<table border="1" cellspacing="1">
 <tr>
  <td align="center" width="48">???</td>
  <td width="32" align="center">??ß≥</td>
  <td align="center" width="216">?????</td>
  <td align="center" width="135">??????</td>
  <td align="center">????</td>
 </tr>
 <tr>
  <td width="48">0</td>
  <td width="32">2</td>
  <td width="216">Magic</td>
  <td width="135">???</td>
  <td>?????????????????????????????<br>
  0x10B???????????32¶À?????????<br>
  0x107???????????ROM????<br>
  0x20B???????????64¶À?????????</td>
 </tr>
 <tr>
  <td>2</td>
  <td>1</td>
  <td>MajorLinkerVersion</td>
  <td>???????????∑⁄??</td>
  <td>???????????∑⁄???</td>
 </tr>
 <tr>
  <td>3</td>
  <td>1</td>
  <td>MinorLinkerVersion</td>
  <td>?????????∑⁄??</td>
  <td>?????????∑⁄???</td>
 </tr>
 <tr>
  <td>4</td>
  <td>4</td>
  <td>SizeOfCode</td>
  <td>??????ß≥</td>
  <td>???????.text??????????ßÿ??????????????????ß’?????????????FileAlignment?????????????????????ß≥??</td>
 </tr>
 <tr>
  <td>8</td>
  <td>4</td>
  <td>SizeOfInitializedData</td>
  <td>??????????ß≥</td>
  <td>???????.data??????????ßÿ??????????????????????ßª???????????FileAlignment?????????????????????ß≥??</td>
 </tr>
 <tr>
  <td>12</td>
  <td>4</td>
  <td>SizeOfUninitializedData</td>
  <td>¶ƒ?????????ß≥</td>
  <td>???????.bss??????????ßÿ??????????????????????ßª???????????FileAlignment?????????????????????ß≥??</td>
 </tr>
 <tr>
  <td>16</td>
  <td>4</td>
  <td>AddressOfEntryPoint</td>
  <td>????</td>
  <td>???????????????????????????RVA???????????????????????????????????0???ImageBase?????ß≥?????dll??????????</td>
 </tr>
 <tr>
  <td>20</td>
  <td>4</td>
  <td>BaseOfCode</td>
  <td>??????</td>
  <td>??????????????????????RVA????????SectionAlignment??????????</td>
 </tr>
 <tr>
  <td>24</td>
  <td>4</td>
  <td>BaseOfData</td>
  <td>??????</td>
  <td>??????????????????????RVA??????64¶À????ß’???????????????ImageBase?ß≥?????????SectionAlignment??????????</td>
 </tr>
 <tr>
  <td>28/24</td>
  <td>4/8</td>
  <td>ImageBase</td>
  <td><b><font size="5" color="#0000FF">??????</font></b></td>
  <td>?????????????????1??????????????????????64K???????DLL?????10000000H??Windows CE ??EXE?????00010000H??Windows ??ß÷?EXE?????00400000H??</td>
 </tr>
 <tr>
  <td>32</td>
  <td>4</td>
  <td>SectionAlignment</td>
  <td>??????</td>
  <td>????????????????????????????????????FileAlignment??????????????????ß≥??</td>
 </tr>
 <tr>
  <td>36</td>
  <td>4</td>
  <td>FileAlignment</td>
  <td>???????</td>
  <td>?????????????????ß÷???????????????????????????????????512??64K????2????????????????????????????512?????<b>SectionAlignment</b>ß≥?????????????ß≥?????FileAlignment??????SectionAlignment????</td>
 </tr>
 <tr>
  <td>40</td>
  <td>2</td>
  <td>MajorOperatingSystemVersion</td>
  <td>?????????∑⁄??</td>
  <td>????????∑⁄???????????????????????????ûL????Windows XP??5.1??5?????∑⁄???1???∑⁄??</td>
 </tr>
 <tr>
  <td>42</td>
  <td>2</td>
  <td>MinorOperatingSystemVersion</td>
  <td>???????∑⁄??</td>
  <td>??</td>
 </tr>
 <tr>
  <td>44</td>
  <td>2</td>
  <td>MajorImageVersion</td>
  <td>????????∑⁄??</td>
  <td>??</td>
 </tr>
 <tr>
  <td>46</td>
  <td>2</td>
  <td>MinorImageVersion</td>
  <td>??????∑⁄??</td>
  <td>??</td>
 </tr>
 <tr>
  <td>48</td>
  <td>2</td>
  <td>MajorSubsystemVersion</td>
  <td>?????????∑⁄??</td>
  <td>??</td>
 </tr>
 <tr>
  <td>50</td>
  <td>2</td>
  <td>MinorSubsystemVersion</td>
  <td>???????∑⁄??</td>
  <td>??</td>
 </tr>
 <tr>
  <td>52</td>
  <td>2</td>
  <td>Win32VersionValue</td>
  <td>???????????0</td>
  <td>??</td>
 </tr>
 <tr>
  <td>56</td>
  <td>4</td>
  <td>SizeOfImage</td>
  <td>?????ß≥</td>
  <td>?????????????????ß≥?????????ß÷????????????????SectionAlignment???????</td>
 </tr>
 <tr>
  <td>60</td>
  <td>4</td>
  <td>SizeOfHeaders</td>
  <td>???ß≥</td>
  <td>??????????ß≥???????????FileAlignment??????????????????PE???????????????????</td>
 </tr>
 <tr>
  <td>64</td>
  <td>4</td>
  <td>CheckSum</td>
  <td>ßµ???</td>
  <td>?????????ßµ????????ßµ???????????????Imagehlp.DLL ?ß≥????????????????ßµ???????????????????ß÷??????????¶ ???????????????DLL???????????Windows?????ß÷?DLL??</td>
 </tr>
 <tr>
  <td>68</td>
  <td>2</td>
  <td>Subsystem</td>
  <td>????????</td>
  <td>???ß’????????????????¶œ???????<a href="#3.2.3">Windows????</a>???????</td>
 </tr>
 <tr>
  <td>70</td>
  <td>2</td>
  <td>DllCharacteristics</td>
  <td>DLL???</td>
  <td>?¶œ???????<a href="#3.2.4">DLL????</a>???????</td>
 </tr>
 <tr>
  <td>72</td>
  <td>4/8</td>
  <td>SizeOfStackReserve</td>
  <td>?????????ß≥</td>
  <td>???<b>?</b>??ß≥??<b>CPU????</b>???????1MB??</td>
 </tr>
 <tr>
  <td>76/80</td>
  <td>4/8</td>
  <td>SizeOfStackCommit</td>
  <td>???????ß≥</td>
  <td>???????????ß≥???????4KB??</td>
 </tr>
 <tr>
  <td>80/88</td>
  <td>4/8</td>
  <td>SizeOfHeapReserve</td>
  <td>???????ß≥</td>
  <td>???<b>??</b>??ß≥??<b>???????????</b>???????1MB??</td>
 </tr>
 <tr>
  <td>84/96</td>
  <td>4/8</td>
  <td>SizeOfHeapCommit</td>
  <td>???????ß≥</td>
  <td>??????????????ß≥???????4KB??</td>
 </tr>
 <tr>
  <td>88/104</td>
  <td>4</td>
  <td>LoaderFlags</td>
  <td>???????????0</td>
  <td>??</td>
 </tr>
 <tr>
  <td>92/108</td>
  <td>4</td>
  <td>NumberOfRvaAndSizes</td>
  <td>???????</td>
  <td>????????????????????????ß÷?Windows NT???????????16??</td>
 </tr>

</table>
<p>??3????????????128??????</p>
<table border="1" cellspacing="1">
 <tr>
  <td align="center">
  <p align="center">???<br>(PE32/PE32+)</td>
  <td align="center">??ß≥</td>
  <td align="center">?????</td>
  <td align="center">????</td>
 </tr>
 <tr>
  <td>96/112</td>
  <td>8</td>
  <td>Export Table</td>
  <td><b>??????</b>???????ß≥???¶œ?5.1???<a href="#5.1">.edata</a>??</td>
 </tr>
 <tr>
  <td>104/120</td>
  <td>8</td>
  <td>Import Table</td>
  <td><b>????????</b>???????ß≥???¶œ?5.2.1???<a href="#5.2">.idata</a>??</td>
 </tr>
 <tr>
  <td>112/128</td>
  <td>8</td>
  <td>Resource Table</td>
  <td><b>?????</b>???????ß≥???¶œ?5.6???<a href="#5.6">.rsrc</a>??</td>
 </tr>
 <tr>
  <td>120/136</td>
  <td>8</td>
  <td>Exception Table</td>
  <td><b>????</b>???????ß≥???¶œ?5.3???<a href="#5.3">.pdata</a>??</td>
 </tr>
 <tr>
  <td>128/144</td>
  <td>8</td>
  <td>Certificate Table</td>
  <td><b>????????</b>???????ß≥???¶œ?6???<a href="#6">????????</a>??</td>
 </tr>
 <tr>
  <td>136/152</td>
  <td>8</td>
  <td>Base Relocation Table</td>
  <td><b>??????¶À??</b>???????ß≥???¶œ?5.4???<a href="#5.4">.reloc</a>??</td>
 </tr>
 <tr>
  <td>144/160</td>
  <td>8</td>
  <td>Debug</td>
  <td>?????????????????ß≥??</td>
 </tr>
 <tr>
  <td>152/168</td>
  <td>8</td>
  <td>Architecture</td>
  <td>???????????0</td>
 </tr>
 <tr>
  <td>160/176</td>
  <td>8</td>
  <td>Global Ptr</td>
  <td>?????õ•?????????????ß÷???????RVA??<b>???????Size??????0</b></td>
 </tr>
 <tr>
  <td>168/184</td>
  <td>8</td>
  <td>TLS Table</td>
  <td><b>??????õ•??TLS????</b>???????ß≥??</td>
 </tr>
 <tr>
  <td>176/192</td>
  <td>8</td>
  <td>Load Config Table</td>
  <td><b>?????????</b>???????ß≥???¶œ?5.5???<a href="#5.5">?????????</a>??</td>
 </tr>
 <tr>
  <td>184/200</td>
  <td>8</td>
  <td>Bound Import</td>
  <td><b>?????????</b>???????ß≥???¶œ?5.2.2???<a href="#5.2.4">????????</a>??</td>
 </tr>
 <tr>
  <td>192/208</td>
  <td>8</td>
  <td>IAT</td>
  <td><b>????????</b>???????ß≥???¶œ?5.2.4???<a href="#5.2.4">????????</a>??</td>
 </tr>
 <tr>
  <td>200/216</td>
  <td>8</td>
  <td>Delay Import Descriptor</td>
  <td><b>????????????</b>???????ß≥??</td>
 </tr>
 <tr>
  <td>208/224</td>
  <td>8</td>
  <td>CLR Runtime Header</td>
  <td>CLR???????????????ß≥??(????)</td>
 </tr>
 <tr>
  <td>216/232</td>
  <td>8</td>
  <td colspan="2">
  <p align="center">???????????0</p></td>
 </tr>
</table>

<h3><a name="3.2.1"></a>3.2.1 ????????</h3>
<p>Machine?????????????ß÷?????????CPU?????????????????????????????????????????????????????????</p>

<table border="1" cellspacing="1">
 <tr>
  <td align="center">?</td>
  <td align="center">????</td>
 </tr>
 <tr>
  <td>0x0</td>
  <td>???????¶ ??????????</td>
 </tr>
 <tr>
  <td>0x1d3</td>
  <td>Matsushita AM33??????</td>
 </tr>
 <tr>
  <td height="22">0x8664</td>
  <td height="22">x64??????</td>
 </tr>
 <tr>
  <td>0x1c0</td>
  <td>ARMß≥¶¬??????</td>
 </tr>
 <tr>
  <td>0xebc</td>
  <td>EFI?????????</td>
 </tr>
 <tr>
  <td><font color="red"><b>0x14c</b></font></td>
  <td><font color="red"><b>Intel 386?????????????????????</b></font></td>
 </tr>
 <tr>
  <td>0x200</td>
  <td>Intel Itanium??????</td>
 </tr>
 <tr>
  <td>0x9041</td>
  <td>Mitsubishi M32Rß≥¶¬??????</td>
 </tr>
 <tr>
  <td>0x266</td>
  <td>MIPS16??????</td>
 </tr>
 <tr>
  <td>0x366</td>
  <td>??FPU??MIPS??????</td>
 </tr>
 <tr>
  <td>0x466</td>
  <td>??FPU??MIPS16??????</td>
 </tr>
 <tr>
  <td>0x1f0</td>
  <td>PowerPCß≥¶¬??????</td>
 </tr>
 <tr>
  <td>0x1f1</td>
  <td>??????????????PowerPC??????</td>
 </tr>
 <tr>
  <td>0x166</td>
  <td>MIPSß≥¶¬??????</td>
 </tr>
 <tr>
  <td>0x1a2</td>
  <td>Hitachi SH3??????</td>
 </tr>
 <tr>
  <td>0x1a3</td>
  <td>Hitachi SH3 DSP??????</td>
 </tr>
 <tr>
  <td>0x1a6</td>
  <td>Hitachi SH4??????</td>
 </tr>
 <tr>
  <td>0x1a6</td>
  <td>Hitachi SH5??????</td>
 </tr>
 <tr>
  <td>0x1c2</td>
  <td>Thumb??????</td>
 </tr>
 <tr>
  <td>0x169</td>
  <td>MIPSß≥¶¬WCE v2??????</td>
 </tr>
</table>

<h3><a name="3.2.2"></a>3.2.2 ????</h3>
<p>Characteristics??????????????????????????????????????????????????????????¶À????¶À????</p>

<table border="1" cellspacing="1">
 <tr>
  <td align="center">¶À??</td>
  <td align="center">????</td>
 </tr>
 <tr>
  <td>0</td>
  <td>???????????????????????¶À????????????????????????????????????????????????????????</td>
 </tr>
 <tr>
  <td>1</td>
  <td>????????????????????????????ß÷?????????????????</td>
 </tr>
 <tr>
  <td>2</td>
  <td rowspan="3">???????????0??</td>
 </tr>
 <tr>
  <td>3</td>
 </tr>
 <tr>
  <td>4</td>
 </tr>
 <tr>
  <td>5</td>
  <td>??®Æ?????????????2GB??????</td>
 </tr>
 <tr>
  <td>6</td>
  <td rowspan="2">???????????0??</td>
 </tr>
 <tr>
  <td>7</td>
 </tr>
 <tr>
  <td>8</td>
  <td>???????????32¶À???????</td>
 </tr>
 <tr>
  <td>9</td>
  <td>??????????????????????????</td>
 </tr>
 <tr>
  <td>10</td>
  <td>????????????????????????????????????????????????????ß≥?????????</td>
 </tr>
 <tr>
  <td>11</td>
  <td>???????????????????????????????????????????????????ß≥?????????</td>
 </tr>
 <tr>
  <td>12</td>
  <td>??????????????????????????????</td>
 </tr>
 <tr>
  <td>13</td>
  <td>?????????????????DLL????</td>
 </tr>
 <tr>
  <td>14</td>
  <td>????????????????????????????</td>
 </tr>
 <tr>
  <td>15</td>
  <td>???????????0??</td>
 </tr>
</table>

<p><b><a name="3.2.3"></a>Windows????</b></p>
<p>?NT???2?????Subsystem???????????????????ß‡????????Windows????????????????</p>
<table border="1" cellspacing="1">
 <tr>
  <td align="center">?</td>
  <td align="center">????</td>
 </tr>
 <tr>
  <td>0</td>
  <td>¶ƒ????? </td>
 </tr>
 <tr>
  <td><b>1</b></td>
  <td><b>?ıÙ?????????Native Windows????</b></td>
 </tr>
 <tr>
  <td><b>2</b></td>
  <td><b>Windows?????????ó§GUI??????????????</b></td>
 </tr>
 <tr>
  <td><b>3</b></td>
  <td><b>Windows???????CUI??????????????????????????</b></td>
 </tr>
 <tr>
  <td>7</td>
  <td>Posix?????????</td>
 </tr>
 <tr>
  <td>9</td>
  <td>Windows CE</td>
 </tr>
 <tr>
  <td>10</td>
  <td>????????????EFI????®Æ???</td>
 </tr>
 <tr>
  <td>11</td>
  <td>???????????EFI????????</td>
 </tr>
 <tr>
  <td>12</td>
  <td>????????????EFI????????</td>
 </tr>
 <tr>
  <td>13</td>
  <td>EFI ROM????</td>
 </tr>
 <tr>
  <td>14</td>
  <td>XBOX</td>
 </tr>
</table>

<p><b><a name="3.2.4"></a>DLL????</b></p>
<p>?NT???DllCharacteristics?????????????</p>
<table border="1" cellspacing="1">
 <tr>
  <td align="center">¶À??</td>
  <td align="center">????</td>
 </tr>
 <tr>
  <td>1</td>
  <td rowspan="4">???????????0??</td>
 </tr>
 <tr>
  <td>2</td>
 </tr>
 <tr>
  <td>3</td>
 </tr>
 <tr>
  <td>4</td>
 </tr>
 <tr>
  <td>5</td>
  <td>????????</td>
 </tr>
 <tr>
  <td>6</td>
  <td>????????</td>
 </tr>
 <tr>
  <td>7</td>
  <td>DLL???????????????¶À??</td>
 </tr>
 <tr>
  <td>8</td>
  <td>?????ß’?????????ßµ?Óï</td>
 </tr>
 <tr>
  <td>9</td>
  <td>?????????NX??</td>
 </tr>
 <tr>
  <td>10</td>
  <td>?????????????????????</td>
 </tr>
 <tr>
  <td>11</td>
  <td>????????????SE????????</td>
 </tr>
 <tr>
  <td>12</td>
  <td>???????</td>
 </tr>
 <tr>
  <td>13</td>
  <td>???????????0??</td>
 </tr>
 <tr>
  <td>14</td>
  <td>WDM????????</td>
 </tr>
 <tr>
  <td>15</td>
  <td>????????</td>
 </tr>
 <tr>
  <td>16</td>
  <td>??????????????????</td>
 </tr>
</table>

<p>???????????????Windows???????????????????ß≥????ßª???????????????????????????????????®¢??????????????????????????8??????</p>
<p>typedef struct<br>
&nbsp;&nbsp;DWORD VirtualAddress;&nbsp;&nbsp;//?????RVA<br>
&nbsp;&nbsp;DWORD Size;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//??????ß≥<br>
typedef ENDS</p>
<p>
??1?????VirtualAddress????????????RVA?????????????????NT???2?????ImageBase<br>
??2?????????????ß≥??????????????????????NT????????????</p>
<p>
<b>Certificate Table???????????????????????????????????????????????RVA??</b></p>
<h2><a name="3.3"></a>3.3 ???</h2>

<p>?????????ßµ???????RVA???????????????????????????????ßª??¶À????????????????ßµ???????ßªRVA???????NT???SectionAlignment????????</p>
<p>???????????????????????40??????</p>
<table border="1" cellspacing="1">
 <tr>
  <td width="35">???</td>
  <td width="35">??ß≥</td>
  <td align="center">?????</td>
  <td align="center">????</td>
 </tr>
 <tr>
  <td width="35">0</td>
  <td width="35">8</td>
  <td>Name</td>
  <td>???????8???ASCII????????????????8??????NULL???<b>????????8???</b>?????????????8??????????????NULL?????????ß‡????????????8?????????</td>
 </tr>
 <tr>
  <td width="35">8</td>
  <td width="35">4</td>
  <td>VirtualSize</td>
  <td>?????????????????<b>??</b>??ß≥??????????SizeOfRawData???????????????0?????????????????ßﬂ??ßÿ????????????ß≥?????????????</td>
 </tr>
 <tr>
  <td width="35">12</td>
  <td width="35">4</td>
  <td>VirtualAddress</td>
  <td>????ßﬂ???????????????????????SectionAlignment??????????</td>
 </tr>
 <tr>
  <td width="35">16</td>
  <td width="35">4</td>
  <td>SizeOfRawData</td>
  <td>?????????<b>??</b>???????????ß≥??????????NT???FileAlignment?????????????ßﬂ?????¶ƒ???????????????????????0??</td>
 </tr>
 <tr>
  <td width="35">20</td>
  <td width="35">4</td>
  <td>PointerToRawData</td>
  <td>????????????????????????????NT???FileAlignment?????????????ßﬂ?????¶ƒ???????????????????????0??</td>
 </tr>
 <tr>
  <td width="35">24</td>
  <td width="35">4</td>
  <td>PointerToRelocations</td>
  <td>???¶À??????????????????????????????¶À??????????????????0??</td>
 </tr>
 <tr>
  <td width="35">28</td>
  <td width="35">4</td>
  <td colspan="2">????????</td>
 </tr>
 <tr>
  <td width="35">32</td>
  <td width="35">2</td>
  <td>NumberOfRelocations</td>
  <td>???????¶À???????????????????????????¶À??????????????????0??</td>
 </tr>
 <tr>
  <td width="35">34</td>
  <td width="35">2</td>
  <td colspan="2">????????</td>
 </tr>
 <tr>
  <td width="35">36</td>
  <td width="35">4</td>
  <td>Characteristics</td>
  <td>?????????????????¶œ???<a href="#3.3.1">????</a>????</td>
 </tr>
</table>

<h2><a name="3.3.1"></a>3.3.1 ????</h2>
<p>????ß÷?Characteristics?????????????????????????????????????</p>
<table border="1" cellspacing="1">
 <tr>
  <td>¶À??</td>
  <td>????</td>
 </tr>
 <tr>
  <td>1</td>
  <td rowspan="5">??????</td>
 </tr>
 <tr>
  <td>2</td>
 </tr>
 <tr>
  <td>3</td>
 </tr>
 <tr>
  <td>4</td>
 </tr>
 <tr>
  <td>5</td>
 </tr>
 <tr>
  <td><b>6</b></td>
  <td><b>??????????ß’???????¶¬??®¢?.text??</b></td>
 </tr>
 <tr>
  <td><b>7</b></td>
  <td><b>?????????????????????.data??</b></td>
 </tr>
 <tr>
  <td>8</td>
  <td>??????¶ƒ??????????????.bss??</td>
 </tr>
 <tr>
  <td>9</td>
  <td rowspan="7">??????</td>
 </tr>
 <tr>
  <td>10</td>
 </tr>
 <tr>
  <td>11</td>
 </tr>
 <tr>
  <td>12</td>
 </tr>
 <tr>
  <td>13</td>
 </tr>
 <tr>
  <td>14</td>
 </tr>
 <tr>
  <td>15</td>
 </tr>
 <tr>
  <td>16</td>
  <td>???????????????GP??????????????</td>
 </tr>
 <tr>
  <td>17</td>
  <td rowspan="8">??????</td>
 </tr>
 <tr>
  <td>18</td>
 </tr>
 <tr>
  <td>19</td>
 </tr>
 <tr>
  <td>20</td>
 </tr>
 <tr>
  <td>21</td>
 </tr>
 <tr>
  <td>22</td>
 </tr>
 <tr>
  <td>23</td>
 </tr>
 <tr>
  <td>24</td>
 </tr>
 <tr>
  <td>25</td>
  <td>??????????????¶À?????</td>
 </tr>
 <tr>
  <td>26</td>
  <td>????????????????????</td>
 </tr>
 <tr>
  <td>27</td>
  <td>??????????µµ</td>
 </tr>
 <tr>
  <td>28</td>
  <td>????????????????????ß≥?</td>
 </tr>
 <tr>
  <td>29</td>
  <td>????????????ß€?????</td>
 </tr>
 <tr>
  <td><b>30</b></td>
  <td><b>???????????????ß≥?</b></td>
 </tr>
 <tr>
  <td><b>31</b></td>
  <td><b>??????????????????????</b></td>
 </tr>
 <tr>
  <td><b>32</b></td>
  <td><b>????ß’??</b></td>
 </tr>
</table>

<p>??25??????????????¶À???????????????????????????16¶À?????????¶∂???????65535?????????????????????????????ß÷?NumberOfRelocations??????0xffff????????????¶À????????????????????¶À???VirtualAddress??32¶À???ß≥???????????25????????ß÷????¶À??????????0xffff???????????????</p>
<h1><a name="4"></a>4 ?ßª??????</h1>
<p><b>1.PE????????????</b></p>
<p>
SizeOfHeaders???????????????1????????????????????PE????????????????????????????????0x3C????59????????????4????PE?????????????????????????????????????DOS????ß≥??NT???32¶À????244??????64¶À????260??????????ß≥??NT????1?????NumberOfSections???????????*40????????????40?????®Æ???????DOS???NT??????3??????ß≥?????????????????FileAlignment???????????????????????ß≥?????SizeOfHeaders?????ß≥?????</p>
<p>
<b>2.????????????</b></p>
<p>
Windows???NumberOfSections??????????????????????????????0?????????????????????????NumberOfSections?????????????ß€’«??????????0????????????????????????????????0????NumberOfSections????????????????</p>
<p>
<b>3.¶ƒ?????????</b></p>
<p>
??¶ƒ????????????????????????????????????????????????????????????ß≥??????????????¶ƒ?????????????????ß≥????????????????????????????????????<br>
??¶ƒ???????????????2???1??????????VirtualSize&gt;SizeOfRawData??¶ƒ???????????ß≥????VirtualSize-SizeOfRawData?????2????????????????<b>??????¶ƒ???????????</b>???????SizeOfUninitializedData????0??????
??????1?????????????.data?????????????</p>
<p>
<b>4.??????????</b></p>
<p>
???????????????????ß‘???<b>???????????????????????????????</b>?????????SizeOfInitializedData?????????????ß≥????¶∂?????????????????????ßª??????????????????¶≈???</p>
<p>
<b>5.??????????</b></p>
<p>
???NT???SectionAlignment????ß≥?????<b>??????</b>????ßª??????????CPU???????????????CPU????????????????ß≥???????????????????CPU???????x86?????????ß≥??4K??IA-64?????????ß≥??8K??MIPS?????????ß≥??4K??Itanium?????????ß≥??8K????????????ß≥???????????????ßª???????????????????????????????????????????????????????ß÷?¶À???????????????ß÷?¶À??????????????????????????RVA?????</p>
<p>
<b>6.?????ß≥</b></p>
<p>
SizeOfImage????????<b>??ùÿ???ß≥??ß—???????????????????</b>?????????????????????????????????????????µµ?????????’«????????????????????????????????????????????????????????????</p>
<p>
<b>7.????????</b></p>
<p>
CPU?????????4????????¶±?????¶±?????¶±?????¶±??????????????????????ß’???¶ ?????¶≤?????¶ ????¶Œ????????ß’????????????®¥??PE???????????????????BaseOfCode??BaseOfData?????????????»…???????????????<br>
??BaseOfCode??BaseOfData???????????????????????VirtualAddress??????????????????????????????????????¶±??????????????????????????????????????????????????????????¶ƒ???????????<br>
?????ß÷???????????????????ó®???????????????????????????????????????????????????????????????????????????<br>
???????????????????????????¶À????????????????????????ßª????????????</p>
<h1><a name="5"></a>5 ??????</h1>

<p>?°¿??????????????????????????????????????????????ß÷??????????????ßª???????????????????????????????????????????????</p>
<table border="1" cellspacing="1">
 <tr>
  <td>????</td>
  <td>????</td>
 </tr>
 <tr>
  <td>.bss</td>
  <td>¶ƒ???????????</td>
 </tr>
 <tr>
  <td><b>.data</b></td>
  <td><b>?????</b></td>
 </tr>
 <tr>
  <td><b>.edata</b></td>
  <td><b>??????</b></td>
 </tr>
 <tr>
  <td><b>.idata</b></td>
  <td><b>?????</b></td>
 </tr>
 <tr>
  <td>.idlsym</td>
  <td>??????????SEH?????????????IDL????</td>
 </tr>
 <tr>
  <td>.pdata</td>
  <td>?????</td>
 </tr>
 <tr>
  <td><b>.rdata</b></td>
  <td><b>?????????????????????????</b></td>
 </tr>
 <tr>
  <td><b>.reloc</b></td>
  <td><b>???¶À???</b></td>
 </tr>
 <tr>
  <td><b>.rsrc</b></td>
  <td><b>?????</b></td>
 </tr>
 <tr>
  <td>.sbss</td>
  <td>??GP????¶ƒ?????????</td>
 </tr>
 <tr>
  <td>.sdata</td>
  <td>??GP??????????????</td>
 </tr>
 <tr>
  <td>.srdata</td>
  <td>??GP???????????</td>
 </tr>
 <tr>
  <td><b>.text</b></td>
  <td><b>???????</b></td>
 </tr>
 
</table>

<h2><a name="5.1"></a>5.1 .edata??</h2>
<p>???A?????K?????B???????????K???????????????????????????????DLL?ßµ????????exe?????</p>
<p>?°¿???????????????????</p>

<table border="1" cellspacing="1">
 <tr>
  <td align="center">????</td>
  <td width="849" align="center">????</td>
 </tr>
 <tr>
  <td>????????</td>
  <td width="849">???????????????????????¶À?®≤??ß≥??</td>
 </tr>
 <tr>
  <td>?????????</td>
  <td width="849">??????????????RVA???????Óï???????????????????????????????????????????????????????????????????????????????????????®≤?????</td>
 </tr>
 <tr>
  <td>????????????</td>
  <td width="849">????????????????????????????ÔÖ??<b>????</b>???ß≥???ß≥ß’???ß≥?</td>
 </tr>
 <tr>
  <td>??????????</td>
  <td width="849">
  ?????????????????????ß⁄???????????????????Óï????????????¶À?????????????????????????????????????????????????</td>
 </tr>
 <tr>
  <td>?????????</td>
  <td width="849">??????NULL??¶¬??ASCII??????????????????????ß÷??????????????????????????????????????????????????????</td>
 </tr>
</table>

<p>
????????????????????????????Win32???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????«˚???????¶À?®¢????????????????????????????ßŸ????</p>
<p>
??????????????????????????????????????????????????????????????????????????????????ßπ??????????????????????????????????????????????????ß÷???????</p>
<h3>5.1.1 ????????</h3>
<p>?????????????????????????????????????????????????????????????</p>
<table border="1" cellspacing="1">
 <tr>
  <td width="32">???</td>
  <td width="32">??ß≥</td>
  <td width="168" align="center">?????</td>
  <td align="center">????</td>
 </tr>
 <tr>
  <td width="32" align="center">0</td>
  <td width="32" align="center">4</td>
  <td width="168">Export Flags</td>
  <td>???????????0??</td>
 </tr>
 <tr>
  <td width="32" align="center">4</td>
  <td width="32" align="center">4</td>
  <td width="168">Time/Date StampMajor Version</td>
  <td>??????????????????????????????NT?????????TimeDateStamp?????</td>
 </tr>
 <tr>
  <td width="32" align="center">8</td>
  <td width="32" align="center">2</td>
  <td width="168">Major Version</td>
  <td>???∑⁄???</td>
 </tr>
 <tr>
  <td width="32" align="center">10</td>
  <td width="32" align="center">2</td>
  <td width="168">Minor Version</td>
  <td>??∑⁄???</td>
 </tr>
 <tr>
  <td width="32" align="center">12</td>
  <td width="32" align="center">4</td>
  <td width="168">Name RVA</td>
  <td>???????DLL?????ASCII???????RVA???????NULL????¶¬??</td>
 </tr>
 <tr>
  <td width="32" align="center">16</td>
  <td width="32" align="center">4</td>
  <td width="168">Ordinal Base</td>
  <td>????????????????????????????????1??</td>
 </tr>
 <tr>
  <td width="32" align="center">20</td>
  <td width="32" align="center">4</td>
  <td width="168">NumberOfFunctions</td>
  <td>??????????<b>????</b>?????????</td>
 </tr>
 <tr>
  <td width="32" align="center">24</td>
  <td width="32" align="center">4</td>
  <td width="168">NumberOfNames</td>
  <td>??????????????????????????????????????????????????</td>
 </tr>
 <tr>
  <td width="32" align="center">28</td>
  <td width="32" align="center">4</td>
  <td width="168">AddressOfFunctions</td>
  <td>?????????RVA??</td>
 </tr>
 <tr>
  <td width="32" align="center">32</td>
  <td width="32" align="center">4</td>
  <td width="168">AddressOfNames</td>
  <td>????????????RVA??</td>
 </tr>
 <tr>
  <td width="32" align="center">36</td>
  <td width="32" align="center">4</td>
  <td width="168">AddressOfNameOrdinals</td>
  <td>??????????RVA??</td>
 </tr>
</table>

<h3>5.1.2 ???????????Export Address Table??EAT??</h3>
<p>???????????????°¿???????????????????????????<b>????</b>¶À???????????????????NT????????ßµ???????????????Export RVA????????????????Forwarder RVA?????????????¶À??????DLL?ß÷??????????</p>
<table border="1" cellspacing="1">
 <tr>
  <td width="32">???</td>
  <td width="32">??ß≥</td>
  <td>??</td>
  <td width="779">????</td>
 </tr>
 <tr>
  <td width="32" align="center">0</td>
  <td width="32" align="center">4</td>
  <td>Export RVA</td>
  <td>?????????????????????RVA??</td>
 </tr>
 <tr>
  <td width="32" align="center">0</td>
  <td width="32" align="center">4</td>
  <td>Forwarder RVA</td>
  <td width="779">?????????????????NULL??¶¬??ASCII????????????????????????¶À??Export Table????????????????????????¶∂?????????????????????????????DLL???????????????????????????≥èMYDLL.expfunc??????????DLL?????????????????????????????≥èMYDLL.#27??????</td>
 </tr>
</table>

<p>Forwarder RVA???????????????ßÿ??????????????????????????????????????????????????????????????????????????????????????</p>
<p>???????Windows 
XP???ß÷?Kernel32.dll?????????????????HeapAlloc???????????NTDLL.RtlAllocateHeap????????????????®Æ??????Windows XP???ß÷?Ntdll.dll????????????????¶ ???????????????®Æ???????????Kernel32.dll?ß€??</p>
<p>?????????????????0???????????????ß÷????????????????????????∑⁄????????????˙ë??</p>
<h3>5.1.3 ????????????</h3>
<p>?????????????????????????ß÷????????????RVA?????????Óï??????????????????????????</p>
<p><b>??ß÷??????????????ß—?????????????????????????????????????????â^</b>???—ˆ???????????????????ß·????0????????????????∑⁄?????</p>
<h3>5.1.4 ??????????</h3>
<p>??????????????????????????????????????ÔÖ?????????16¶À??????????????<b>???</b>Ordinal Base???????????????????????????????????????????????????????????????????0???????????????????Ordinal Base?????˙ë????????????????????????????????????????????????</p>
<p>????????????????????????????????????ß÷????ÔÖ??????????????????????????????ƒ•?????4????????????2??????????????ß”??????????????????????ß⁄?????????????????????????????????ß⁄??????????????????????????????????????????????????????????????????????????<br>
</p>

<h3>5.1.5 ???????????Export Name Table??ENT??</h3>
<p>
????????????????????????????NULL??¶¬??ASCII?????????
?????????????????????????????????????????????????RVA??????????????????1?????????????????ß÷??????????????????????????????????????®≤???</p>
<h3>
5.1.6 ????</h3>
<p>
????????????<br>
???????????????????®≤??????????????????????????????????????????????????????ß·???????????????????????????????Windows 
XP??????Server 
2????????ß‹???????????ß‡????????????????????????????????¶≤?????????????????????????????????????????????????ßª???????????????????????????????????????????????????????????????????????</p>
<p>
???®≤?????????<br>
???????????®≤???????????????????????AddressOfNames??2????????????????????????????????????????X??????????????AddressOfNameOrdinals???????X??????????<b>???</b>Ordinal Base?????????????????????</p>
<h2><a name="5.2"></a>5.2.idata??</h2>
<p>
??????????????????????????????????????????????????????????ß÷????????????????import???????????????????¶À?????????????DLL???????????????????ßª????????????????????????????DLL????????????????????????PE????ß“?????????? 
??? data directory ????®¿?</p>
<p>????ß÷???????????????????</p>
<p align="center"><img border="0" src="1.bmp" width="278" height="329"></p>
<p align="center">????????????</p>
<h3><a name="5.2.1"></a>5.2.1 ????????</h3>
<p>
??????????????????????????ÔÖ???????????????????????DLL???????????????????????????????NULL??????????????????¶¬??</p>
<p>???????????????????</p>
<table border="1" cellspacing="1">
 <tr>
  <td width="32" align="center">???</td>
  <td width="32" align="center">??ß≥</td>
  <td align="center">??</td>
  <td align="center">????</td>
 </tr>
 <tr>
  <td width="32" align="center">0</td>
  <td width="32" align="center">4</td>
  <td>Import Lookup Table RVA</td>
  <td>??????????RVA????????????????????????????????????</td>
 </tr>
 <tr>
  <td width="32" align="center">4</td>
  <td width="32" align="center">4</td>
  <td>Time/Date Stamp</td>
  <td>?????????????DLL??????????????????DLL??????/??????</td>
 </tr>
 <tr>
  <td width="32" align="center">8</td>
  <td width="32" align="center">4</td>
  <td>Forwarder Chain</td>
  <td>?????????????????</td>
 </tr>
 <tr>
  <td width="32" align="center">12</td>
  <td width="32" align="center">4</td>
  <td>Name RVA</td>
  <td>????DLL?????ASCII???????RVA??</td>
 </tr>
 <tr>
  <td width="32" align="center">16</td>
  <td width="32" align="center">4</td>
  <td>Import Address RVA</td>
  <td>??????????RVA???????????????????????????????????</td>
 </tr>
</table>

<h3><a name="5.2.2"></a>5.2.2 ????????</h3>
<p>????????????????32¶À(PE32)??64¶À(PE32+)?????????????Óï???ß÷???????????¶À?????????°¿???????????????ßµ?¶À31(PE32)??¶À63(PE32+)?????¶À????ßª??????????????DLL????????ß‹??????????????????0(NULL)??????????????¶¬??</p>

<table border="1" cellspacing="1">
 <tr>
  <td width="40" align="center">???</td>
  <td width="32" align="center">??ß≥</td>
  <td align="center">¶À??</td>
  <td align="center" width="722">????</td>
 </tr>
 <tr>
  <td align="center" width="40">31/63</td>
  <td align="center" width="32">1</td>
  <td>Ordinal/Name Flag</td>
  <td width="722">??????¶À?1?????????????????????????????????????????????¶À???????0x80000000(PE32)??)0x8000000000000000(PE32+)??</td>
 </tr>
 <tr>
  <td align="center" width="40">15-0</td>
  <td align="center" width="32">16</td>
  <td>Ordinal Number</td>
  <td width="722">?????(16¶À??)????ß÷?Ordinal/Name Flag???1(?????????????)???????????¶À30-15(PE32)??62-15(PE32+)?????0??</td>
 </tr>
 <tr>
  <td align="center" width="40">30-0</td>
  <td align="center" width="32">31</td>
  <td>Hint/Name Table RVA</td>
  <td width="722">???/????????RVA(31¶À??)????ß÷?Ordinal/Name Flag???0(????????????)??????????????PE32+?????¶À62-31?????0??</td>
 </tr>
</table>

<h3><a name="5.2.3"></a>5.2.3 ???/?????</h3>
<p>???/??????ß÷??????????????</p>
<table border="1" cellspacing="1">
 <tr>
  <td width="32">???</td>
  <td width="32">??ß≥</td>
  <td width="32">??</td>
  <td>????</td>
 </tr>
 <tr>
  <td width="32">0</td>
  <td width="32">2</td>
  <td width="32">Hint</td>
  <td>????????????????????????????????????????????????????????????DLL??????????????ßﬂ???2??????????</td>
 </tr>
 <tr>
  <td width="32">2</td>
  <td width="32">???</td>
  <td width="32">Name</td>
  <td>???????????????ASCII???????????????????????DLL???????????????????????????????ß≥ß’??????NULL??¶¬??</td>
 </tr>
 <tr>
  <td width="32">*</td>
  <td width="32">0??1</td>
  <td width="32">Pad</td>
  <td>????????/?????????????????????????????????????????0????1??NULL????</td>
 </tr>
</table>

<h3><a name="5.2.4"></a>5.2.4 ????????</h3>
<p>
???????????????????????????????????????????????????ßµ??????????32¶À(PE32)??64¶À(PE32+)???????????????ß÷????????ßª????????????????????????????????????????????????????????????????????</p>
<h2><a name="5.3"></a>5.3 .pdata??????ß·??????????????????????????????</h2>
<p>.pdata????????????????????????????????ÓïNT??ß÷?Exception Table???????????????????????????????????????????ßª?????????????????????????????????????????????????????3??????????????????????????</p>
<p>????32¶À??MIPS??????????Åâ?????????????</p>
<table border="1" cellspacing="1">
 <tr>
  <td width="32" align="center">???</td>
  <td width="32" align="center">??ß≥</td>
  <td width="150" align="center">??</td>
  <td width="320" align="center">????</td>
 </tr>
 <tr>
  <td width="32">0</td>
  <td width="32">4</td>
  <td width="150">Begin Address</td>
  <td width="320">?????????VA</td>
 </tr>
 <tr>
  <td width="32">4</td>
  <td width="32">4</td>
  <td width="150">End Address</td>
  <td width="320">??????¶¬??VA</td>
 </tr>
 <tr>
  <td width="32">8</td>
  <td width="32">4</td>
  <td width="150">Exception Handler</td>
  <td width="320">??????ß÷???????????????</td>
 </tr>
 <tr>
  <td width="32">12</td>
  <td width="32">4</td>
  <td width="150">Handler Data</td>
  <td width="320">???????????????????????????????</td>
 </tr>
 <tr>
  <td width="32">16</td>
  <td width="32">4</td>
  <td width="150">Prolog End Address</td>
  <td width="320">????prolog?????¶¬??VA</td>
 </tr>
</table>
<p>????ARM??PowerPC??SH3??SH4 Windows CE????????Åâ?????????????</p>
<table border="1" cellspacing="1">
 <tr>
  <td width="32" align="center">???</td>
  <td width="32" align="center">??ß≥</td>
  <td width="120" align="center">??</td>
  <td width="590" align="center">????</td>
 </tr>
 <tr>
  <td width="32">0</td>
  <td width="32">4</td>
  <td width="120">Begin Address</td>
  <td width="590">?????????VA</td>
 </tr>
 <tr>
  <td width="32">4</td>
  <td width="32">8¶À</td>
  <td width="120">Prolog Length</td>
  <td width="590">????prolog??????????????</td>
 </tr>
 <tr>
  <td width="32">4</td>
  <td width="32">22¶À</td>
  <td width="120">Function Length</td>
  <td width="590">??????????????????</td>
 </tr>
 <tr>
  <td width="32">4</td>
  <td width="32">1¶À</td>
  <td width="120">32-bit Flag</td>
  <td width="590">?????¶À?1????????????32¶À?????®¿??????????16¶À?????®¿?</td>
 </tr>
 <tr>
  <td width="32">4</td>
  <td width="32">1¶À</td>
  <td width="120">Exception Flag</td>
  <td width="590">?????¶À?1????????????????????????????????????????????????</td>
 </tr>
</table>

<p>????x64??Itanium????????Åâ?????????????</p>
<table border="1" cellspacing="1">
 <tr>
  <td align="center">???</td>
  <td align="center">??ß≥</td>
  <td align="center">??</td>
  <td align="center">????</td>
 </tr>
 <tr>
  <td>0</td>
  <td>4</td>
  <td>Begin Address</td>
  <td>?????????RVA</td>
 </tr>
 <tr>
  <td>4</td>
  <td>4</td>
  <td>End Address</td>
  <td>??????¶¬??RVA</td>
 </tr>
 <tr>
  <td>8</td>
  <td>4</td>
  <td>Unwind Information</td>
  <td>???????????????(Unwind)?????RVA</td>
 </tr>
</table>
<h2><a name="5.4"></a>5.4 .reloc??</h2>
<p>??????¶À???????????????????????¶À???????NT??ß÷????????ß÷?Base Relocation Table????????¶À????????????????¶À????????????????????¶À?????????????ÔÖ?????????4K??úZ¶∂????????¶À????????????32¶À??¬C???</p>
<h3><a name="5.4.1"></a>5.4.1 ??????¶À??</h3>
<p>?????????¶À????????????????</p>
<table border="1" cellspacing="1">
 <tr>
  <td align="center">???</td>
  <td align="center">??ß≥</td>
  <td align="center">??</td>
  <td align="center">????</td>
 </tr>
 <tr>
  <td align="center">0</td>
  <td align="center">4</td>
  <td>Page RVA</td>
  <td>???????????????(???RVA)????????????????????¶√????VA?????VA????????ß›?????¶À??????</td>
 </tr>
 <tr>
  <td align="center">4</td>
  <td align="center">4</td>
  <td>Block Size</td>
  <td>??????¶À???????????????????ß—???Page RVA???Block Size?????????????????Type/Offset??</td>
 </tr>
</table>
<p>Block Size?????????????????Type/Offset¶À???????ß÷????????????WORD??2??????????????</p>
<table border="1" cellspacing="1">
 <tr>
  <td width="40" align="center">???</td>
  <td width="40" align="center">??ß≥</td>
  <td align="center">??</td>
  <td align="center">????</td>
 </tr>
 <tr>
  <td width="40" align="center">0</td>
  <td width="40" align="center">4¶À</td>
  <td>Type</td>
  <td>??????WORD?????4¶À?????????????????????¶À??????¶œ?5.4.2???<a href="#5.4.2">??????¶À????</a>????</td>
 </tr>
 <tr>
  <td width="40" align="center">0</td>
  <td width="40" align="center">12¶À</td>
  <td>Offset</td>
  <td>??????WORD??????12¶À??????????????¶À???Page RVA???????????????????????????????????ß›?????¶À??¶À?®¢?</td>
 </tr>
</table>
<p>?????ß›?????¶À???????????????????????????????????????????????????????????????????????????????????????????????ß›?????¶À???</p>
<h3><a name="5.4.2"></a>5.4.2 ??????¶À????</h3>
<table border="1" width="950" cellspacing="1">
 <tr>
  <td align="center">?</td>
  <td align="center">????</td>
 </tr>
 <tr>
  <td>0</td>
  <td>??????¶À????????????????????????????????????</td>
 </tr>
 <tr>
  <td>1</td>
  <td>??????¶À?????????16¶À???????????????16¶À????????16¶À???????32¶À????????</td>
 </tr>
 <tr>
  <td>2</td>
  <td>??????¶À?????????16¶À???????????????16¶À????????16¶À???????32¶À????????</td>
 </tr>
 <tr>
  <td>3</td>
  <td>??????¶À??????ß÷?32¶À??????????????????32¶À?????</td>
 </tr>
 <tr>
  <td>4</td>
  <td>???ß›?????¶À?????????16¶À???????????????16¶À????????16¶À???????32¶À?????????????32¶À?????????õ•??????????Type/Offset¶À?????????16¶À???ß≥????????????????????¶À?????????Type/Offset¶À???¶À?®¢?</td>
 </tr>
 <tr>
  <td>5</td>
  <td>??MIPS????????????ß›?????¶À??</td>
 </tr>
 <tr>
  <td>6</td>
  <td>???????????0</td>
 </tr>
 <tr>
  <td>7</td>
  <td>???????????0</td>
 </tr>
 <tr>
  <td>9</td>
  <td>??MIPS16????????????ß›?????¶À??</td>
 </tr>
 <tr>
  <td>10</td>
  <td>???ß›?????¶À?????????????????????</td>
 </tr>

</table>

<h2><a name="5.5"></a>5.5 ???????????????????????????????</h2>
<p>????????????????Windows NT??????????????????????????????????????NT???????????????????????ßª????????????∑⁄??Microsoft????????Windows XP????????∑⁄??Windows??????????????°„∑⁄??????????????????SEH?????????x86??32¶À?????????????????????????????????ß“???????????????????????????ßª????????????????????????????????VA??¶∂??????????????????????SEH????????????????????????????????????????????ß“??ßµ????????????????????®Æ???????????????®¢?x86?????????????????????????????????????????®¥???</p>

<p>Microsoft????????????????????????????????????????SEH?????????????????????????????????????????????????????????????SEH??????????????????????????SEH????????????????????????????????????SEH??</p>
<h3><a name="5.5.1"></a>5.5.1 ??????????</h3>
<p>????????????SEH???????????????????????????????????????????ß≥???????????????????????????????????????????????????ß≥????????????????∑⁄???????Windows XP???????∑⁄??Windows?????x86?????????????????ß≥?????64??</p>
<h3><a name="5.5.2"></a>5.5.2 ?????????????</h3>
<p>????32¶À??64¶ÀPE??????????????????????</p>
<table border="1" cellspacing="1">
 <tr>
  <td width="32">???</td>
  <td width="32">??ß≥</td>
  <td>??</td>
  <td>????</td>
 </tr>
 <tr>
  <td width="32">0</td>
  <td width="32">4</td>
  <td>Characteristics</td>
  <td>?????????????????¶ƒ?®¢?</td>
 </tr>
 <tr>
  <td width="32">4</td>
  <td width="32">4</td>
  <td>TimeDateStamp</td>
  <td>????/???????????????UTC???1970??1??1?????(00:00:00)??????????????????????????????????????????C?????????time??????????????</td>
 </tr>
 <tr>
  <td width="32">8</td>
  <td width="32">2</td>
  <td>MajorVersion</td>
  <td>???∑⁄??</td>
 </tr>
 <tr>
  <td width="32">10</td>
  <td width="32">2</td>
  <td>MinorVersion</td>
  <td>??∑⁄??</td>
 </tr>
 <tr>
  <td width="32">12</td>
  <td width="32">4</td>
  <td>GlobalFlagsClear</td>
  <td>??????????????????????????????????????????</td>
 </tr>
 <tr>
  <td width="32">16</td>
  <td width="32">4</td>
  <td>GlobalFlagsSet</td>
  <td>??????????????????????????????????????????</td>
 </tr>
 <tr>
  <td width="32">20</td>
  <td width="32">4</td>
  <td>CriticalSectionDefaultTimeout</td>
  <td>??????????????????????????????????????</td>
 </tr>
 <tr>
  <td width="32">24</td>
  <td width="32">8</td>
  <td>DeCommitFreeBlockThreshold</td>
  <td>???????????????????????????????????</td>
 </tr>
 <tr>
  <td width="32">32</td>
  <td width="32">8</td>
  <td>DeCommitTotalFreeThreshold</td>
  <td>??????????????????????</td>
 </tr>
 <tr>
  <td width="32">40</td>
  <td width="32">8</td>
  <td>LockPrefixTable</td>
  <td>?????????x86???????????????ß“???VA?????????ß“??ß“?????????LOCK??????????????????????????????????????ßªLOCK???ùI?NOP???</td>
 </tr>
 <tr>
  <td width="32">48</td>
  <td width="32">8</td>
  <td>MaximumAllocationSize</td>
  <td>?????????????????????</td>
 </tr>
 <tr>
  <td width="32">56</td>
  <td width="32">8</td>
  <td>VirtualMemoryThreshold</td>
  <td>????????????ß≥???????????</td>
 </tr>
 <tr>
  <td width="32">64</td>
  <td width="32">8</td>
  <td>ProcessAffinityMask</td>
  <td>???????????????????ßπ??????????????????⁄Ö???????????????SetProcessAffinityMask??????????????.exe???????</td>
 </tr>
 <tr>
  <td width="32">72</td>
  <td width="32">4</td>
  <td>ProcessHeapFlags</td>
  <td>???????????????????????????????ßª?????????????????????ß’???????</td>
 </tr>
 <tr>
  <td width="32">76</td>
  <td width="32">2</td>
  <td>CSDVersion</td>
  <td>Service Pack?∑⁄?????</td>
 </tr>
 <tr>
  <td width="32">78</td>
  <td width="32">2</td>
  <td>Reserved</td>
  <td>?????0</td>
 </tr>
 <tr>
  <td width="32">80</td>
  <td width="32">8</td>
  <td>EditList</td>
  <td>????????????®¢?</td>
 </tr>
 <tr>
  <td width="32">60/88</td>
  <td width="32">4/8</td>
  <td>SecurityCookie</td>
  <td>???cookie?????cookie??Visual C++????????GS???????®¢?</td>
 </tr>
 <tr>
  <td width="32">64/96</td>
  <td width="32">4/8</td>
  <td>SEHandlerTable</td>
  <td>?????????x86???????????????ß“???VA?????????ß“??ß“????????????????????????????SE?????????RVA???????????????RVA????</td>
 </tr>
 <tr>
  <td width="32">68/104</td>
  <td width="32">4/8</td>
  <td>SEHandlerCount</td>
  <td>?????????x86??????ßÿ???????SE??????????????</td>
 </tr>

</table>

<h2><a name="5.6"></a>5.6 .rsrc??</h2>
<p>??????????????????????????????????????????????3???????????????????????????????????</p>
<p>??????????????16?????????????????????????????????????12???????ßÿ??»…?????????????????????¶ ?????????</p>
<p>???1???????????????????????????????????21???????????16???????Óï????????????????ID???????????????????????????????????????????ID????ßÿ??????<b>???????ß÷????????????ß÷?ID?????</b>???????ß÷??????????????ßµ?????????????????ß≥ß’???????????ID??????????????0-3??????????????????????????????32¶À????????4-7???????????????????????????????????</p>
<p>????????????????°§??????????????????????????????????????????????????????????????????????????ID??????????????????????????????????????????????????????????????????????????????????????????????????????????????????ß‘?????????????</p>
<p>?????????????????????ID????????????????°§??????????1????????????ID????2???????????????ß÷???????????????ID????3????????????ID??</p>
<p>.rsrc????????????</p>
<table border="1" cellspacing="1">
 <tr>
  <td align="center">????</td>
  <td width="854" align="center">????</td>
 </tr>
 <tr>
  <td>???????</td>
  <td width="854">???ß÷???????????????????1?????ß≥???????ß÷???????2??????????2??????????ID???????????ID???????3??????????ID??????ID???????????ID?????????????????????????????????????????????????????????????????????????????</td>
 </tr>
 <tr>
  <td>???????</td>
  <td width="854">??</td>
 </tr>
 <tr>
  <td>??????????</td>
  <td width="854">??2?????????Unicode???????????????????????????????????????????</td>
 </tr>
 <tr>
  <td>???????????</td>
  <td width="854">??????????????ÔÖ????????????????????????????ß≥??¶À?®¢???ßª???????????????ß÷?????</td>
 </tr>
 <tr>
  <td>???????</td>
  <td width="854">?????????????????????????ß÷??ß≥??¶À?????????????????????????</td>
 </tr>
</table>
<h3>???????</h3>
<table border="1" cellspacing="1">
 <tr>
  <td>???</td>
  <td>??ß≥</td>
  <td>??</td>
  <td>????</td>
 </tr>
 <tr>
  <td>0</td>
  <td>4</td>
  <td>Characteristics</td>
  <td>????????????????????®¢?????????????0??</td>
 </tr>
 <tr>
  <td>4</td>
  <td>4</td>
  <td>Time/Date Stamp</td>
  <td>??????????????????????????</td>
 </tr>
 <tr>
  <td>8</td>
  <td>2</td>
  <td>Major Version</td>
  <td>???∑⁄?????????⁄Ö??</td>
 </tr>
 <tr>
  <td>10</td>
  <td>2</td>
  <td>Minor Version</td>
  <td>??∑⁄?????????⁄Ö??</td>
 </tr>
 <tr>
  <td>12</td>
  <td>2</td>
  <td>Number of Name Entries</td>
  <td>??????????????????????????ßª???????<b>?????????</b>?????????????????????</td>
 </tr>
 <tr>
  <td>14</td>
  <td>2</td>
  <td>Number of ID Entries</td>
  <td>??????????????????????????ßª???????<b>????</b>?????????????????????</td>
 </tr>
</table>
<h3>???????</h3>
<p>???????????????????????????????????ID???????????Óï??????????????????????ß·????????????????????ID????????????ó®?????????ˆˆ???ß·????</p>
<table border="1" cellspacing="1">
 <tr>
  <td>???</td>
  <td>??ß≥</td>
  <td>??</td>
  <td>????</td>
 </tr>
 <tr>
  <td>0</td>
  <td>4</td>
  <td>Name RVA</td>
  <td>?????????????????ID??????????????????</td>
 </tr>
 <tr>
  <td>0</td>
  <td>4</td>
  <td>Integer ID</td>
  <td>?????????????????ID???32¶À??????</td>
 </tr>
 <tr>
  <td>4</td>
  <td>4</td>
  <td>Data Entry RVA</td>
  <td>???¶À?0????31¶À????????????????</td>
 </tr>
 <tr>
  <td>4</td>
  <td>4</td>
  <td>Subdirectory RVA</td>
  <td>???¶À?1????31¶À???????????????????????????</td>
 </tr>
</table>
<h3>??????????</h3>
<p>???????????????????????Unicode???????®¿???ßª????????õ•?????????????????????????????????????????????ßª?????????????????????????????????????ß≥???????????????????????</p>
<table border="1" cellspacing="1">
 <tr>
  <td>???</td>
  <td>??ß≥</td>
  <td>??</td>
  <td>????</td>
 </tr>
 <tr>
  <td>0</td>
  <td>2</td>
  <td>Length</td>
  <td>?????????????????Length??????</td>
 </tr>
 <tr>
  <td>2</td>
  <td>???</td>
  <td>Unicode String</td>
  <td>??? Unicode String ???????????????Unicode???????</td>
 </tr>
</table>
<h3>?????????</h3>
<p>??????????????????????????????????????????????????????????????</p>
<table border="1" cellspacing="1">
 <tr>
  <td>???</td>
  <td>??ß≥</td>
  <td>??</td>
  <td>????</td>
 </tr>
 <tr>
  <td>0</td>
  <td>4</td>
  <td>Data RVA</td>
  <td>???????????????????????????????</td>
 </tr>
 <tr>
  <td>4</td>
  <td>4</td>
  <td>Size</td>
  <td>??Data RVA???????????????ß≥???????????</td>
 </tr>
 <tr>
  <td>8</td>
  <td>4</td>
  <td>Codepage</td>
  <td>???????????????ß÷??????????????????????????????Unicode???????</td>
 </tr>
 <tr>
  <td>12</td>
  <td>4</td>
  <td>???????????0</td>
  <td>???????????0</td>
 </tr>
</table>

<h1><a name="6"></a>6 ????????</h1>
<p>????????????????????????????????????????????ßÿ????????????????ÔÖ???????Authenticode?????</p>
<p>?????????????????????????????????????NT??ß÷????????ß÷?Certificate Table??????????????????????????????????????????????¶À?®≤??????õ•????????ß÷??????˙Y??????????????????????????????????????????ß≥????????????????ß≥??8?????????????????ß≥???????????????????????ßª?????????????Óï</p>
<p>??????????????</p>
<table border="1" cellspacing="1">
 <tr>
  <td>???</td>
  <td>??ß≥</td>
  <td>??</td>
  <td>????</td>
 </tr>
 <tr>
  <td>0</td>
  <td>4</td>
  <td>Certificate Data</td>
  <td>?????????????????????????????????8????????ƒ•?????3??¶À????0??????</td>
 </tr>
 <tr>
  <td>0</td>
  <td>4</td>
  <td>Size of Certificate</td>
  <td>????????????????????????????ß≥???????????</td>
 </tr>
</table>

<p>
???????????8?????????????????¬C???16????????????¬C???????????????????8??????????????????????????0????????????????≥á??????¯A???????????ßª????0??????¶ ¶ƒ????????????????????????????8???????????????????Óï</p>
<p>???????¶À?®≤??????????????????????????????˙Y??¶∏????????????????</p>

</body>

</html>